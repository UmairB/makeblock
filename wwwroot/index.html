<!DOCTYPE html>
<html>
<head>
    <base href="/">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title></title>

    <link rel="stylesheet" href="/app/app.css" />

    <script src="/lib/es6-shim/es6-shim.js"></script>
    <script src="/lib/systemjs/system.js"></script>
    <script>
        System.config({
            defaultJSExtensions: true,
            map: {
                'app': 'app',
                'nipplejs': '/lib/nipplejs/nipplejs',
                'angular': '/lib/angular/angular.min',
                'angular-deferred-bootstrap': '/lib/angular/angular-deferred-bootstrap.min',
                'socket.io-client': '/socket.io/socket.io'
            },
            meta: {
                'nipplejs': {
                    format: 'global'
                },
                'angular': {
                    format: 'global'
                },
                'angular-deferred-bootstrap': {
                    format: 'global',
                    deps: ['angular']
                },
                'app/app': {
                    deps: ['angular', 'nipplejs', 'socket.io-client']
                },
                'app/bootstrap': {
                    deps: ['angular-deferred-bootstrap']
                }
            }
        });

        Promise.all([
            System.import('app/AppCtrl'),
            System.import('app/joystick/JoystickDirective')
        ])
        .then(function() { return System.import('app/bootstrap'); })
        .catch(console.error.bind(console));
    </script>
</head>
<body ng-controller="appCtrl as app">
    <div class="container">
        <div class="sensor-distance row">
            <h2>Distance:&nbsp;<span class="app.distance"></span></h2>
        </div>
        <div class="joystick-row row">
            <div class="joystick-container" ng-class="{'disabled':app.joystickDisabled, 'loading':app.checkingAvailability}">
                <span class="loader">
                    <span class="ic-loading"></span>
                </span>
                <joystick api="app.joystickApi"></joystick>
            </div>
        </div>
        <div class="connection-state row" ng-class="app.connectionState">
            <span class="state">State:&nbsp;<span>{{app.connectionState}}</span></span>
            <button class="btn" ng-click="app.connectButton.click()">{{app.connectButton.text}}</button>
        </div>
    </div>
</body>
</html>
